<script src="https://aframe.io/releases/0.6.1/aframe.min.js"></script><script>AFRAME.registerComponent("orbit",{schema:{ir:{type:"number"},or:{type:"number"}},multiple:!0,init:function(){this.orbiting=!1,console.log(this);let a=this.el,b=[];for(let c=0;3>c;c++)b[c]=document.createElement("a-ring"),b[c].setAttribute("radius-outer",this.data.or),b[c].setAttribute("radius-inner",this.data.ir),b[c].setAttribute("color","grey"),b[c].setAttribute("opacity","0.1"),b[c].setAttribute("material","side:double"),b[c].addEventListener("mouseenter",this.mouseEnter),b[c].addEventListener("mouseleave",this.mouseExit),a.appendChild(b[c]);b[0].setAttribute("rotation","0 0 0"),b[1].setAttribute("rotation","0 90 90"),b[2].setAttribute("rotation","90 90 0"),this.orbits=b},enterOrbit:function(){this.orbiting=!0;for(let a=0;3>a;a++)this.el.removeChild(this.orbits[a])},exitOrbit:function(){this.orbiting=!1;for(let a=0;3>a;a++)this.el.appendChild(this.orbits[a])},mouseEnter:(a)=>{a.target.setAttribute("opacity","0.5")},mouseExit:(a)=>{a.target.setAttribute("opacity","0.1")}}),AFRAME.registerComponent("moon",{dependencies:["position","camera","look-controls"],init:function(){var a=Math.atan2;this.d=2*Math.PI/1000,this.t=0,this.state=0,this.time=0,this.angle=0,this.movement={},this.r="000",this.orbiting=document.querySelector("#initial").components.orbit,this.orbiting.enterOrbit(),this.oldOrbit=null,this.o={x:0,y:0,z:0,h:50},this.planes={"000":(a,b,c)=>{let d=this.computeLoc(b-this.o.x,c-this.o.y,this.angle);this.angle=d.a,a.setAttribute("position",{x:d.x+this.o.x,y:d.y+this.o.y,z:this.o.z})},"09090":(a,b,c,d)=>{let e=this.computeLoc(c-this.o.y,d-this.o.z,this.angle);this.angle=e.a,a.setAttribute("position",{x:this.o.x,y:e.x+this.o.y,z:e.y+this.o.z})},90900:(a,b,c,d)=>{let e=this.computeLoc(b-this.o.x,d-this.o.z,this.angle);this.angle=e.a,a.setAttribute("position",{x:e.x+this.o.x,y:this.o.y,z:e.y+this.o.z})}},this.el.querySelector("a-entity[cursor]").addEventListener("click",(b)=>{if(0===this.state&&!b.detail.intersectedEl.parentEl.components.orbit.orbiting){console.log(b);let c=b.detail.intersection,d=this.el.getAttribute("position"),e=1e3*c.distance/15.7,f={};f.t=e/10,f.x=(c.point.x-d.x)/f.t,f.y=(c.point.y-d.y)/f.t,f.z=(c.point.z-d.z)/f.t,f.dest=c.point,this.movement=f;let g=b.detail.intersectedEl.getAttribute("rotation");switch(console.log(g),this.r=""+g.x+g.y+g.z,console.log(this.r),this.orbiting.exitOrbit(),this.old=this.orbiting,this.orbiting=b.detail.intersectedEl.parentEl.components.orbit,this.o=b.detail.intersectedEl.parentEl.getAttribute("position"),this.r){case"000":this.o.h=this.dist(c.point.x,this.o.x,c.point.y,this.o.y),this.angle=a(c.point.y-this.o.y,c.point.x-this.o.x);break;case"09090":this.o.h=this.dist(c.point.y,this.o.y,c.point.z,this.o.z),this.angle=a(c.point.y-this.o.y,c.point.z-this.o.z);;break;case"000":this.o.h=this.dist(c.point.z,this.o.z,c.point.x,this.o.x),this.angle=a(c.point.x-this.o.x,c.point.z-this.o.z);}console.log(this.o),this.state=1}})},tick:function(a){if(!(10>a-this.time)){let a=this.el;switch(this.state){case 0:let b=a.getAttribute("position");this.planes[this.r](a,b.x,b.y,b.z);break;case 1:let c=this.movement,d=a.getAttribute("position");a.setAttribute("position",{x:d.x+c.x,y:d.y+c.y,z:d.z+c.z}),this.t++,this.t>c.t&&(a.setAttribute("position",c.dest),console.log("hit!"),this.t=0,this.state=0,this.orbiting.enterOrbit());}}},computeLoc:function(a,b){let c=Math.atan2(b,a)+this.d;return{a:c,x:this.o.h*Math.cos(c),y:this.o.h*Math.sin(c)}},dist:function(a,b,c,d){var e=Math.pow;return Math.sqrt(e(b-a,2)+e(d-c,2))}});</script><a-scene><a-sphere id="initial" orbit="ir:4;or:30" position="0 0 0" radius="4" color="#4CC3D9"></a-sphere><a-sphere orbit="ir:4;or:30" position="100 0 200" radius="4" color="#93D4CC"></a-sphere><a-sphere orbit="ir:4;or:30" position="100 0 0" radius="4" color="#93D4CC"></a-sphere><a-entity moon camera position="50 0 0" look-controls><a-entity cursor="fuse: false" position="0 0 -1" geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03" material="color: black; shader: flat"></a-entity><a-sphere radius="1" color="green"></a-sphere></a-entity></a-scene><script></script>